"""
Generates multiple hosts file entries based on a base domain and IP address.
Supports both IPv4 and IPv6.
"""


import ipaddress
import re


def generate_hosts(base_domain: str, base_ip: str, count: int):
    hosts = []
    base = ipaddress.ip_address(base_ip)

    # Find the last numeric sequence anywhere in the base_domain
    match = re.search(r"(\d+)(?!.*\d)", base_domain)
    if not match:
        raise ValueError("Base domain must contain at least one number, e.g. ws1-01.local.com")

    num_str = match.group(1)
    num_len = len(num_str)
    num = int(num_str)

    # Split into prefix (everything before the number) and suffix (everything after)
    start, end = match.span()
    prefix = base_domain[:start]
    suffix = base_domain[end:]

    for i in range(count):
        ip = base + i
        new_num = str(num + i).zfill(num_len)
        hostname = f"{prefix}{new_num}{suffix}"
        hosts.append(f"{ip}    {hostname}")

    return hosts


def main():
    base_domain = input("Enter the base domain (e.g. ws1-01.anything.you.want): ").strip()
    base_ip = input("Enter the starting IP (IPv4 or IPv6): ").strip()
    count = int(input("How many entries to generate? "))

    hosts = generate_hosts(base_domain, base_ip, count)

    print("\nGenerated hosts entries:\n")
    for line in hosts:
        print(line)


if __name__ == "__main__":
    main()

