"""A simple hash cracker that supports MD5, SHA1, SHA256, and SHA512 algorithms."""


import hashlib
import pyfiglet
import sys


ascii_banner = pyfiglet.figlet_format("HASH CRACKER")
print(ascii_banner)


wordlist_location = input("Enter wordlist file location: ").strip()
hash_input = input("Enter hash to be cracked: ").strip().lower()
algo_input = input("Choose algorithm (md5, sha1, sha256, sha512) [md5]: ").strip().lower() or "md5"

algos = {
    "md5": hashlib.md5,
    "sha1": hashlib.sha1,
    "sha256": hashlib.sha256,
    "sha512": hashlib.sha512,
}


if algo_input not in algos:
    print("Unsupported algorithm:", algo_input)
    print("Supported:", ", ".join(algos.keys()))
    sys.exit(1)

hash_func = algos[algo_input]


try:
    with open(wordlist_location, "r", encoding="utf-8", errors="ignore") as file:
        for line in file:
            candidate = line.strip()
            if not candidate:
                continue
            h = hash_func(candidate.encode())
            if h.hexdigest() == hash_input:
                print("Found cleartext password!", candidate)
                sys.exit(0)
except FileNotFoundError:
    print("Wordlist file not found:", wordlist_location)
    sys.exit(1)


print("No match found.")
